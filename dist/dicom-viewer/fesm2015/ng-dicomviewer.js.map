{"version":3,"file":"ng-dicomviewer.js","sources":["../../../projects/dicom-viewer/src/lib/cornerstone.directive.ts","../../../projects/dicom-viewer/src/lib/thumbnail.directive.ts","../../../projects/dicom-viewer/src/lib/dicom-viewer.component.ts","../../../projects/dicom-viewer/src/lib/dicom-viewer.module.ts","../../../projects/dicom-viewer/src/public_api.ts","../../../projects/dicom-viewer/src/ng-dicomviewer.ts"],"sourcesContent":["import { Directive, ElementRef, HostListener, OnInit, AfterViewChecked } from '@angular/core';\nimport * as Hammer from 'hammerjs';\n\n\ndeclare const cornerstone;\ndeclare const cornerstoneTools;\ndeclare const cornerstoneMath;\n\n\n\n\n@Directive({\n  selector: '[cornerstone]',\n})\n\nexport class CornerstoneDirective implements OnInit, AfterViewChecked {\n\n  public element: any;\n\n  public imageList = [];\n  private imageIdList = [];\n  public currentIndex = 0;\n  public currentImage: any;\n  public patientName = ''; // current image Patient name, do display on the overlay\n  public hospital = ''; // current image Institution name, to display on the overlay\n  public instanceNumber = ''; // current image Instance #, to display on the overlay\n\n  // cornersTone Tools we use\n  private WwwcTool = cornerstoneTools.WwwcTool;\n  private PanTool = cornerstoneTools.PanTool;\n  private ZoomTool = cornerstoneTools.ZoomTool;\n  private ProbeTool = cornerstoneTools.ProbeTool;\n  private LengthTool = cornerstoneTools.LengthTool;\n  private AngleTool = cornerstoneTools.AngleTool;\n  private EllipticalRoiTool = cornerstoneTools.EllipticalRoiTool;\n  private RectangleRoiTool = cornerstoneTools.RectangleRoiTool;\n  private DragProbeTool = cornerstoneTools.DragProbeTool;\n  private ZoomTouchPinchTool = cornerstoneTools.ZoomTouchPinchTool;\n  private PanMultiTouchTool = cornerstoneTools.PanMultiTouchTool;\n  private StackScrollTool = cornerstoneTools.StackScrollTool;\n  private StackScrollMouseWheelTool = cornerstoneTools.StackScrollMouseWheelTool;\n\n\n  public get windowingValue(): string {\n    if (this.isCornerstoneEnabled) {\n      let viewport = cornerstone.getViewport(this.element);\n      if (this.currentImage && viewport) { return Math.round(viewport.voi.windowWidth) + \"/\" + Math.round(viewport.voi.windowCenter); }\n    }\n    return '';\n  }\n\n  public get zoomValue(): string {\n    if (this.isCornerstoneEnabled) {\n      let viewport = cornerstone.getViewport(this.element);\n      if (this.currentImage && viewport) { return viewport.scale.toFixed(2); }\n    }\n    return '';\n  }\n\n  private isCornerstoneEnabled = false;\n\n  constructor(private elementRef: ElementRef) {\n  }\n\n  @HostListener('window:resize', ['$event'])\n  onResize(event) {\n    if (this.isCornerstoneEnabled) {\n      cornerstone.resize(this.element, true);\n    }\n  }\n\n  @HostListener('wheel', ['$event'])\n  onMouseWheel(event) {\n    event.preventDefault();\n\n    if (this.imageList.length > 0) {\n      const delta = Math.max(-1, Math.min(1, (event.wheelDelta || -event.detail)));\n      // console.log(event);\n\n\n      if (delta > 0) {\n        this.currentIndex++;\n        if (this.currentIndex >= this.imageList.length) {\n          this.currentIndex = this.imageList.length - 1;\n        }\n      } else {\n\n        this.currentIndex--;\n        if (this.currentIndex < 0) {\n          this.currentIndex = 0;\n        }\n\n      }\n\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n\n  }\n\n  ngOnInit() {\n\n    // Retrieve the DOM element itself\n    this.element = this.elementRef.nativeElement;\n\n    // now add the Tools we use\n    cornerstoneTools.external.cornerstone = cornerstone;\n    cornerstoneTools.external.Hammer = Hammer;\n    cornerstoneTools.external.cornerstoneMath = cornerstoneMath;\n    cornerstoneTools.init({ globalToolSyncEnabled: true });\n\n    cornerstoneTools.addTool(this.WwwcTool);\n    cornerstoneTools.addTool(this.PanTool);\n    cornerstoneTools.addTool(this.ZoomTool);\n    cornerstoneTools.addTool(this.ProbeTool);\n    cornerstoneTools.addTool(this.LengthTool);\n    cornerstoneTools.addTool(this.AngleTool);\n    cornerstoneTools.addTool(this.EllipticalRoiTool);\n    cornerstoneTools.addTool(this.RectangleRoiTool);\n    cornerstoneTools.addTool(this.DragProbeTool);\n    cornerstoneTools.addTool(this.ZoomTouchPinchTool);\n    cornerstoneTools.addTool(this.PanMultiTouchTool);\n    cornerstoneTools.addTool(this.StackScrollTool);\n    cornerstoneTools.addTool(this.StackScrollMouseWheelTool);\n\n    // Enable the element with Cornerstone\n    this.resetViewer();\n  }\n\n  ngAfterViewChecked() {\n  //  if (this.currentImage) cornerstone.resize(this.element, true);\n  }\n\n  //\n  // reset the viewer, so only this current element is enabled\n  //\n  public resetViewer() {\n    this.disableViewer();\n    cornerstone.enable(this.element);\n    this.isCornerstoneEnabled = true;\n  }\n\n  public disableViewer() {\n    this.element = this.elementRef.nativeElement;\n    try {\n      cornerstone.disable(this.element);\n    } finally { }\n\n    this.isCornerstoneEnabled = false;\n  }\n\n  public resetImageCache() {\n    this.imageList = [];\n    this.imageIdList = [];\n    this.currentImage = null;\n    this.currentIndex = 0;\n    this.patientName = '';\n    this.hospital = '';\n    this.instanceNumber = '';\n  }\n\n  public previousImage() {\n    if (this.imageList.length > 0) {\n      this.currentIndex--;\n      if (this.currentIndex < 0) {\n        this.currentIndex = 0;\n      }\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n\n  }\n\n  public nextImage() {\n    if (this.imageList.length > 0) {\n      this.currentIndex++;\n      if (this.currentIndex >= this.imageList.length) {\n        this.currentIndex = this.imageList.length - 1;\n      }\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n  }\n\n  public addImageData(imageData: any) {\n    this.element = this.elementRef.nativeElement;\n    //if (!this.imageList.filter(img => img.imageId === imageData.imageId).length) {\n    this.imageList.push(imageData);\n    this.imageIdList.push(imageData.imageId);\n    if (this.imageList.length === 1) {\n      this.currentIndex = 0;\n      this.displayImage(imageData);\n    }\n    //}\n\n    cornerstone.resize(this.element, true);\n  }\n\n  public displayImage(image) {\n    this.element = this.elementRef.nativeElement;\n    const viewport = cornerstone.getDefaultViewportForImage(this.element, image);\n    cornerstone.displayImage(this.element, image, viewport);\n    this.currentImage = image;\n    // Fit the image to the viewport window\n    cornerstone.fitToWindow(this.element);\n    cornerstone.resize(this.element, true);\n\n    // get image info to display in overlays\n    if (image.data.string('x00100010')) this.patientName = image.data.string('x00100010').replace(/\\^/g, '');\n    this.hospital = image.data.string('x00080080');\n    this.instanceNumber = image.data.intString('x00200011') + '/' + image.data.intString('x00200013');\n\n    // Activate mouse clicks, mouse wheel and touch\n    // cornerstoneTools.mouseInput.enable(this.element);\n    // cornerstoneTools.mouseWheelInput.enable(this.element);\n    // //cornerstoneTools.touchInput.enable(this.element);\n    // cornerstoneTools.keyboardInput.enable(this.element);\n\n    // Enable all tools we want to use with this element\n    cornerstoneTools.setToolActiveForElement(this.element, 'Wwwc', { mouseButtonMask: 1 }, ['Mouse']); // ww/wc is the default tool for left mouse button\n    cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 4 }, ['Mouse']); // pan is the default tool for middle mouse button\n    cornerstoneTools.setToolActiveForElement(this.element, 'Zoom', { mouseButtonMask: 2 }, ['Mouse']); // zoom is the default tool for right mouse button\n\n    /*     cornerstoneTools.wwwc.activate(this.element, 1); // ww/wc is the default tool for left mouse button\n        cornerstoneTools.pan.activate(this.element, 2); // pan is the default tool for middle mouse button\n        cornerstoneTools.zoom.activate(this.element, 4); // zoom is the default tool for right mouse button\n        cornerstoneTools.probe.enable(this.element);\n        cornerstoneTools.length.enable(this.element);\n        cornerstoneTools.angle.enable(this.element);\n        cornerstoneTools.simpleAngle.enable(this.element);\n        cornerstoneTools.ellipticalRoi.enable(this.element);\n        cornerstoneTools.rectangleRoi.enable(this.element);\n        cornerstoneTools.wwwcTouchDrag.activate(this.element) // - Drag\n        cornerstoneTools.zoomTouchPinch.activate(this.element) // - Pinch\n        cornerstoneTools.panMultiTouch.activate(this.element) // - Multi (x2) */\n\n    // Stack tools\n\n    // Define the Stack object\n    const stack = {\n      currentImageIdIndex: this.currentIndex,\n      imageIds: this.imageIdList\n    };\n\n    cornerstoneTools.addStackStateManager(this.element, ['playClip']);\n    // Add the stack tool state to the enabled element\n    cornerstoneTools.addStackStateManager(this.element, ['stack']);\n    cornerstoneTools.addToolState(this.element, 'stack', stack);\n    // cornerstoneTools.stackScrollWheel.activate(this.element);\n    // Enable all tools we want to use with this element\n    cornerstoneTools.setToolActiveForElement(this.element, 'StackScroll', {});\n    //cornerstoneTools.stackPrefetch.enable(this.element);\n\n  }\n\n\n  // cornerstone.displayImage(this.element, image);\n  // deactivate all tools\n  public resetAllTools() {\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Wwwc');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Pan');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Zoom');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Probe');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Length');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Angle');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'EllipticalRoi');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'RectangleRoi');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'DragProbe');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'ZoomTouchPinch');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'PanMultiTouch');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'StackScroll');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'StackScrollMouseWheel');\n  }\n\n}\n","import { Directive, ElementRef, OnInit, Input, AfterViewChecked } from '@angular/core';\n\n\ndeclare const cornerstone;\n\n\n@Directive({\n  selector: '[thumbnail]',\n})\n\nexport class ThumbnailDirective implements OnInit, AfterViewChecked {\n\n  @Input() public imageData: any;\n\n  public element: any;\n\n  constructor(private elementRef: ElementRef) {\n  }\n\n  ngOnInit() {\n // Retrieve the DOM element itself\n    this.element = this.elementRef.nativeElement;\n\n    // Enable the element with Cornerstone\n    cornerstone.enable(this.element);\n    this.setImageData(this.imageData);\n  }\n\n  ngAfterViewChecked() {\n    this.refresh();\n  }\n\n  public refresh() {\n    this.setImageData(this.imageData);\n  }\n\n  public setImageData(image) {\n    this.imageData = image;\n    if (this.imageData && this.element) {\n      const viewport = cornerstone.getDefaultViewportForImage(this.element, this.imageData);\n      cornerstone.displayImage(this.element, this.imageData, viewport);\n      // Fit the image to the viewport window\n      cornerstone.fitToWindow(this.element);\n      cornerstone.resize(this.element, true);\n    }\n\n  }\n}\n","import { Component, ViewChild, OnInit, Input, ViewChildren } from '@angular/core';\nimport { CornerstoneDirective } from './cornerstone.directive';\nimport { ThumbnailDirective } from './thumbnail.directive';\n\n\n\ndeclare const cornerstone;\ndeclare const cornerstoneTools;\n\n@Component({\n  selector: 'dicom-viewer',\n  templateUrl: './dicom-viewer.component.html',\n  styleUrls: ['./dicom-viewer.component.css']\n})\nexport class DICOMViewerComponent implements OnInit {\n\n  @Input() public enableViewerTools = false; // enable viewer tools\n  @Input() public enablePlayTools = false; // enable Play Clip tools\n  @Input() public downloadImagesURL = '' // download images URL\n  @Input() public maxImagesToLoad = 20; // limit for the automatic loading of study images\n\n  public seriesList = []; // list of series on the images being displayed\n  public currentSeriesIndex = 0;\n  public currentSeries: any = {};\n  public imageCount = 0; // total image count being viewed\n\n  // control enable/disable image scroll buttons\n  public get hidePreviousImage(): any { return { color: (this.viewPort.currentIndex < 1) ? 'black' : 'white' }; }\n  public get hideNextImage(): any { return { color: (this.viewPort.currentIndex >= (this.imageCount - 1)) ? 'black' : 'white' }; }\n\n  // control message for more images to load\n  public get moreImagestoLoad(): string {\n    if (this.loadedImages.length < this.imageIdList.length && !this.loadingImages) { // are there any more images to load?\n      const imagesToLoad = (this.maxImagesToLoad <= 0) ? (this.imageIdList.length - this.loadedImages.length) : Math.min(this.maxImagesToLoad, this.imageIdList.length - this.loadedImages.length);\n      return imagesToLoad.toString();\n    } else return '';\n  }\n\n  // control exhibition of a loading images progress indicator\n  public loadingImages = false;\n  public get showProgress(): any { return { display: (this.loadingImages) ? 'inline-block' : 'none' } };\n\n  @ViewChild(CornerstoneDirective, { static: true }) viewPort: CornerstoneDirective; // the main cornertone view port\n  @ViewChildren(ThumbnailDirective) thumbnails: Array<ThumbnailDirective>;\n\n  private loadedImages = [];\n  private imageIdList = [];\n  private element: any;\n  private targetImageCount = 0;\n\n  constructor() { }\n\n  ngOnInit() {\n    this.element = this.viewPort.element;\n  }\n\n  /**\n   * Load dicom images for display\n   *\n   * @param imageIdList list of imageIds to load and display\n   */\n  loadStudyImages(imageIdList: Array<any>) {\n    this.element = this.viewPort.element;\n    this.imageIdList = imageIdList;\n    this.viewPort.resetViewer();\n    this.viewPort.resetImageCache(); // clean up image cache\n    this.seriesList = []; // start a new series list\n    this.currentSeriesIndex = 0; // always display first series\n    this.loadedImages = []; // reset list of images already loaded\n\n    //\n    // loop thru all imageIds, load and cache them for exhibition (up the the maximum limit defined)\n    //\n    const maxImages = (this.maxImagesToLoad <= 0) ? imageIdList.length : Math.min(this.maxImagesToLoad, imageIdList.length);\n    this.loadingImages = true; // activate progress indicator\n    this.targetImageCount = maxImages;\n    for (let index = 0; index < maxImages; index++) {\n      const imageId = imageIdList[index];\n      cornerstone.loadAndCacheImage(imageId).then(imageData => { this.imageLoaded(imageData) });\n    }\n\n  }\n\n  /**\n   * Load the next batch of images\n   */\n  public loadMoreImages() {\n    this.element = this.viewPort.element;\n    //\n    // loop thru all imageIds, load and cache them for exhibition (up the the maximum limit defined)\n    //\n    const maxImages = (this.maxImagesToLoad <= 0) ? (this.imageIdList.length - this.loadedImages.length) : Math.min(this.maxImagesToLoad, this.imageIdList.length - this.loadedImages.length);\n    this.loadingImages = true; // activate progress indicator\n    this.targetImageCount += maxImages;\n    let nextImageIndex = this.loadedImages.length;\n    for (let index = 0; index < maxImages; index++) {\n      const imageId = this.imageIdList[nextImageIndex++];\n      cornerstone.loadAndCacheImage(imageId)\n        .then(imageData => { this.imageLoaded(imageData) })\n        .catch(err => { this.targetImageCount--; });\n    }\n\n  }\n\n  /**\n   *\n   * @param imageData the dicom image data\n   */\n  private imageLoaded(imageData) {\n    //console.log(imageData.imageId)\n    // build list of series in all loadded images\n    const series = {\n      studyID: imageData.data.string('x0020000d'),\n      seriesID: imageData.data.string('x0020000e'),\n      seriesNumber: imageData.data.intString('x00200011'),\n      studyDescription: imageData.data.string('x00081030'),\n      seriesDescription: imageData.data.string('x0008103e'),\n      imageCount: 1,\n      imageList: [imageData]\n    }\n    // if this is a new series, add it to the list\n    let seriesIndex = this.seriesList.findIndex(item => item.seriesID === series.seriesID);\n    if (seriesIndex < 0) {\n      seriesIndex = this.seriesList.length;\n      this.seriesList.push(series);\n      this.seriesList.sort((a, b) => {\n        if (a.seriesNumber > b.seriesNumber) return 1;\n        if (a.seriesNumber < b.seriesNumber) return -1;\n        return 0;\n      })\n    } else {\n      let seriesItem = this.seriesList[seriesIndex];\n      seriesItem.imageCount++;\n      seriesItem.imageList.push(imageData);\n      seriesItem.imageList.sort((a, b) => {\n        if (a.data.intString('x00200013') > b.data.intString('x00200013')) return 1;\n        if (a.data.intString('x00200013') < b.data.intString('x00200013')) return -1;\n        return 0;\n      })\n    }\n\n    this.loadedImages.push(imageData); // save to images loaded\n\n    if (seriesIndex === this.currentSeriesIndex) {\n      //this.currentSeries = this.seriesList[seriesIndex];\n      //this.imageCount = this.currentSeries.imageCount; // get total image count\n      //this.viewPort.addImageData(imageData);\n      this.showSeries(this.currentSeriesIndex)\n    }\n\n    if (this.loadedImages.length >= this.targetImageCount) { // did we finish loading images?\n      this.loadingImages = false; // deactivate progress indicator\n    }\n\n  }\n\n  public showSeries(index) {\n    //        this.resetAllTools();\n    this.currentSeriesIndex = index;\n    this.currentSeries = this.seriesList[index];\n    this.imageCount = this.currentSeries.imageCount; // get total image count\n    this.viewPort.resetImageCache(); // clean up image cache\n    //        this.loadingImages = true; // activate progress indicator\n    for (let i = 0; i < this.currentSeries.imageList.length; i++) {\n      const imageData = this.currentSeries.imageList[i];\n      this.viewPort.addImageData(imageData);\n    }\n    //        this.loadingImages = false; // de-activate progress indicator\n  }\n\n  public saveAs() {\n    cornerstoneTools.saveAs(this.element, \"teste.jpg\")\n  }\n\n  /**\n   * Image scroll methods\n   */\n  public nextImage() {\n    if (this.viewPort.currentIndex < this.imageCount) {\n      this.viewPort.nextImage();\n    }\n  }\n\n  public previousImage() {\n    if (this.viewPort.currentIndex > 0) {\n      this.viewPort.previousImage();\n    }\n  }\n\n  /**\n   * Methods to activate/deactivate viewer tools\n   */\n\n  // deactivate all tools\n  public resetAllTools() {\n    if (this.imageCount > 0) {\n      this.viewPort.resetAllTools()\n      this.stopClip();\n    }\n  }\n\n  // activate windowing\n  public enableWindowing() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.wwwc.activate(this.element, 1);\n      // cornerstoneTools.wwwcTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Wwwc', { mouseButtonMask: 1 }, ['Mouse']);\n\n    }\n  }\n\n  // activate zoom\n  public enableZoom() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.zoom.activate(this.element, 5); // 5 is right mouse button and left mouse button\n      // cornerstoneTools.zoomTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Zoom', { mouseButtonMask: 1 }, ['Mouse']); // zoom left mouse\n      // cornerstoneTools.setToolActiveForElement(this.element, 'ZoomTouchPinch', { }, ['Mouse']);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 2 }, ['Mouse']); // pan right mouse\n\n    }\n  }\n\n  // activate pan\n  public enablePan() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.pan.activate(this.element, 3); // 3 is middle mouse button and left mouse button\n      // cornerstoneTools.panTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate image scroll\n  public enableScroll() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.stackScroll.activate(this.element, 1);\n      // cornerstoneTools.stackScrollTouchDrag.activate(this.element);\n      // cornerstoneTools.stackScrollKeyboard.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'StackScroll', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate length measurement\n  public enableLength() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.length.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Length', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate angle measurement\n  public enableAngle() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.simpleAngle.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Angle', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate pixel probe\n  public enableProbe() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.probe.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Probe', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate Elliptical ROI\n  public enableElliptical() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.ellipticalRoi.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'EllipticalRoi', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate Rectangle ROI\n  public enableRectangle() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.rectangleRoi.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'RectangleRoi', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // Play Clip\n  public playClip() {\n    if (this.imageCount > 0) {\n      let frameRate = 10;\n      let stackState = cornerstoneTools.getToolState(this.element, 'stack');\n      if (stackState) {\n        frameRate = stackState.data[0].frameRate;\n        // Play at a default 10 FPS if the framerate is not specified\n        if (frameRate === undefined || frameRate === null || frameRate === 0) {\n          frameRate = 10;\n        }\n      }\n      cornerstoneTools.playClip(this.element, frameRate);\n    }\n  }\n\n  // Stop Clip\n  public stopClip() {\n    cornerstoneTools.stopClip(this.element);\n  }\n\n  // invert image\n  public invertImage() {\n    if (this.imageCount > 0) {\n      let viewport = cornerstone.getViewport(this.element);\n      // Toggle invert\n      if (viewport.invert === true) {\n        viewport.invert = false;\n      } else {\n        viewport.invert = true;\n      }\n      cornerstone.setViewport(this.element, viewport);\n    }\n  }\n\n  // reset image\n  public resetImage() {\n    if (this.imageCount > 0) {\n      let toolStateManager = cornerstoneTools.getElementToolStateManager(this.element);\n      // Note that this only works on ImageId-specific tool state managers (for now)\n      //toolStateManager.clear(this.element);\n      cornerstoneTools.clearToolState(this.element, \"Length\");\n      cornerstoneTools.clearToolState(this.element, \"Angle\");\n      // cornerstoneTools.clearToolState(this.element, \"simpleAngle\");\n      cornerstoneTools.clearToolState(this.element, \"Probe\");\n      cornerstoneTools.clearToolState(this.element, \"EllipticalRoi\");\n      cornerstoneTools.clearToolState(this.element, \"RectangleRoi\");\n      cornerstone.updateImage(this.element);\n      this.resetAllTools();\n    }\n  }\n\n  public clearImage() {\n    this.viewPort.resetViewer();\n    this.viewPort.resetImageCache();\n    this.seriesList = []; // list of series on the images being displayed\n    this.currentSeriesIndex = 0;\n    this.currentSeries = {};\n    this.imageCount = 0; // total image count being viewed\n\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\n\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\n\nimport { DICOMViewerComponent } from './dicom-viewer.component';\nimport { CornerstoneDirective } from './cornerstone.directive';\nimport { ThumbnailDirective } from './thumbnail.directive';\n\n@NgModule({\n  imports: [\n    FormsModule,\n    CommonModule,\n    MatProgressSpinnerModule\n  ],\n  declarations: [DICOMViewerComponent, CornerstoneDirective, ThumbnailDirective],\n  exports: [DICOMViewerComponent, CornerstoneDirective, ThumbnailDirective]\n})\nexport class DicomViewerModule { }\n","/*\n * Public API Surface of dicom-viewer\n */\n\nexport * from './lib/dicom-viewer.component';\nexport * from './lib/cornerstone.directive';\nexport * from './lib/thumbnail.directive';\nexport * from './lib/dicom-viewer.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}