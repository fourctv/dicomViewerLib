{"version":3,"file":"ng-dicomviewer.umd.js","sources":["../../../projects/dicom-viewer/src/lib/cornerstone.directive.ts","../../../projects/dicom-viewer/src/lib/thumbnail.directive.ts","../../../projects/dicom-viewer/src/lib/dicom-viewer.component.ts","../../../projects/dicom-viewer/src/lib/dicom-viewer.module.ts","../../../projects/dicom-viewer/src/public_api.ts","../../../projects/dicom-viewer/src/ng-dicomviewer.ts"],"sourcesContent":["import { Directive, ElementRef, HostListener, OnInit, AfterViewChecked } from '@angular/core';\nimport * as Hammer from 'hammerjs';\n\n\ndeclare const cornerstone;\ndeclare const cornerstoneTools;\ndeclare const cornerstoneMath;\n\n\n\n\n@Directive({\n  selector: '[cornerstone]',\n})\n\nexport class CornerstoneDirective implements OnInit, AfterViewChecked {\n\n  public element: any;\n\n  public imageList = [];\n  private imageIdList = [];\n  public currentIndex = 0;\n  public currentImage: any;\n  public patientName = ''; // current image Patient name, do display on the overlay\n  public hospital = ''; // current image Institution name, to display on the overlay\n  public instanceNumber = ''; // current image Instance #, to display on the overlay\n\n  // cornersTone Tools we use\n  private WwwcTool = cornerstoneTools.WwwcTool;\n  private PanTool = cornerstoneTools.PanTool;\n  private ZoomTool = cornerstoneTools.ZoomTool;\n  private ProbeTool = cornerstoneTools.ProbeTool;\n  private LengthTool = cornerstoneTools.LengthTool;\n  private AngleTool = cornerstoneTools.AngleTool;\n  private EllipticalRoiTool = cornerstoneTools.EllipticalRoiTool;\n  private RectangleRoiTool = cornerstoneTools.RectangleRoiTool;\n  private DragProbeTool = cornerstoneTools.DragProbeTool;\n  private ZoomTouchPinchTool = cornerstoneTools.ZoomTouchPinchTool;\n  private PanMultiTouchTool = cornerstoneTools.PanMultiTouchTool;\n  private StackScrollTool = cornerstoneTools.StackScrollTool;\n  private StackScrollMouseWheelTool = cornerstoneTools.StackScrollMouseWheelTool;\n\n\n  public get windowingValue(): string {\n    if (this.isCornerstoneEnabled) {\n      let viewport = cornerstone.getViewport(this.element);\n      if (this.currentImage && viewport) { return Math.round(viewport.voi.windowWidth) + \"/\" + Math.round(viewport.voi.windowCenter); }\n    }\n    return '';\n  }\n\n  public get zoomValue(): string {\n    if (this.isCornerstoneEnabled) {\n      let viewport = cornerstone.getViewport(this.element);\n      if (this.currentImage && viewport) { return viewport.scale.toFixed(2); }\n    }\n    return '';\n  }\n\n  private isCornerstoneEnabled = false;\n\n  constructor(private elementRef: ElementRef) {\n  }\n\n  @HostListener('window:resize', ['$event'])\n  onResize(event) {\n    if (this.isCornerstoneEnabled) {\n      cornerstone.resize(this.element, true);\n    }\n  }\n\n  @HostListener('wheel', ['$event'])\n  onMouseWheel(event) {\n    event.preventDefault();\n\n    if (this.imageList.length > 0) {\n      const delta = Math.max(-1, Math.min(1, (event.wheelDelta || -event.detail)));\n      // console.log(event);\n\n\n      if (delta > 0) {\n        this.currentIndex++;\n        if (this.currentIndex >= this.imageList.length) {\n          this.currentIndex = this.imageList.length - 1;\n        }\n      } else {\n\n        this.currentIndex--;\n        if (this.currentIndex < 0) {\n          this.currentIndex = 0;\n        }\n\n      }\n\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n\n  }\n\n  ngOnInit() {\n\n    // Retrieve the DOM element itself\n    this.element = this.elementRef.nativeElement;\n\n    // now add the Tools we use\n    cornerstoneTools.external.cornerstone = cornerstone;\n    cornerstoneTools.external.Hammer = Hammer;\n    cornerstoneTools.external.cornerstoneMath = cornerstoneMath;\n    cornerstoneTools.init({ globalToolSyncEnabled: true });\n\n    cornerstoneTools.addTool(this.WwwcTool);\n    cornerstoneTools.addTool(this.PanTool);\n    cornerstoneTools.addTool(this.ZoomTool);\n    cornerstoneTools.addTool(this.ProbeTool);\n    cornerstoneTools.addTool(this.LengthTool);\n    cornerstoneTools.addTool(this.AngleTool);\n    cornerstoneTools.addTool(this.EllipticalRoiTool);\n    cornerstoneTools.addTool(this.RectangleRoiTool);\n    cornerstoneTools.addTool(this.DragProbeTool);\n    cornerstoneTools.addTool(this.ZoomTouchPinchTool);\n    cornerstoneTools.addTool(this.PanMultiTouchTool);\n    cornerstoneTools.addTool(this.StackScrollTool);\n    cornerstoneTools.addTool(this.StackScrollMouseWheelTool);\n\n    // Enable the element with Cornerstone\n    this.resetViewer();\n  }\n\n  ngAfterViewChecked() {\n  //  if (this.currentImage) cornerstone.resize(this.element, true);\n  }\n\n  //\n  // reset the viewer, so only this current element is enabled\n  //\n  public resetViewer() {\n    this.disableViewer();\n    cornerstone.enable(this.element);\n    this.isCornerstoneEnabled = true;\n  }\n\n  public disableViewer() {\n    this.element = this.elementRef.nativeElement;\n    try {\n      cornerstone.disable(this.element);\n    } finally { }\n\n    this.isCornerstoneEnabled = false;\n  }\n\n  public resetImageCache() {\n    this.imageList = [];\n    this.imageIdList = [];\n    this.currentImage = null;\n    this.currentIndex = 0;\n    this.patientName = '';\n    this.hospital = '';\n    this.instanceNumber = '';\n  }\n\n  public previousImage() {\n    if (this.imageList.length > 0) {\n      this.currentIndex--;\n      if (this.currentIndex < 0) {\n        this.currentIndex = 0;\n      }\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n\n  }\n\n  public nextImage() {\n    if (this.imageList.length > 0) {\n      this.currentIndex++;\n      if (this.currentIndex >= this.imageList.length) {\n        this.currentIndex = this.imageList.length - 1;\n      }\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n  }\n\n  public addImageData(imageData: any) {\n    this.element = this.elementRef.nativeElement;\n    //if (!this.imageList.filter(img => img.imageId === imageData.imageId).length) {\n    this.imageList.push(imageData);\n    this.imageIdList.push(imageData.imageId);\n    if (this.imageList.length === 1) {\n      this.currentIndex = 0;\n      this.displayImage(imageData);\n    }\n    //}\n\n    cornerstone.resize(this.element, true);\n  }\n\n  public displayImage(image) {\n    this.element = this.elementRef.nativeElement;\n    const viewport = cornerstone.getDefaultViewportForImage(this.element, image);\n    cornerstone.displayImage(this.element, image, viewport);\n    this.currentImage = image;\n    // Fit the image to the viewport window\n    cornerstone.fitToWindow(this.element);\n    cornerstone.resize(this.element, true);\n\n    // get image info to display in overlays\n    if (image.data.string('x00100010')) this.patientName = image.data.string('x00100010').replace(/\\^/g, '');\n    this.hospital = image.data.string('x00080080');\n    this.instanceNumber = image.data.intString('x00200011') + '/' + image.data.intString('x00200013');\n\n    // Activate mouse clicks, mouse wheel and touch\n    // cornerstoneTools.mouseInput.enable(this.element);\n    // cornerstoneTools.mouseWheelInput.enable(this.element);\n    // //cornerstoneTools.touchInput.enable(this.element);\n    // cornerstoneTools.keyboardInput.enable(this.element);\n\n    // Enable all tools we want to use with this element\n    cornerstoneTools.setToolActiveForElement(this.element, 'Wwwc', { mouseButtonMask: 1 }, ['Mouse']); // ww/wc is the default tool for left mouse button\n    cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 4 }, ['Mouse']); // pan is the default tool for middle mouse button\n    cornerstoneTools.setToolActiveForElement(this.element, 'Zoom', { mouseButtonMask: 2 }, ['Mouse']); // zoom is the default tool for right mouse button\n\n    /*     cornerstoneTools.wwwc.activate(this.element, 1); // ww/wc is the default tool for left mouse button\n        cornerstoneTools.pan.activate(this.element, 2); // pan is the default tool for middle mouse button\n        cornerstoneTools.zoom.activate(this.element, 4); // zoom is the default tool for right mouse button\n        cornerstoneTools.probe.enable(this.element);\n        cornerstoneTools.length.enable(this.element);\n        cornerstoneTools.angle.enable(this.element);\n        cornerstoneTools.simpleAngle.enable(this.element);\n        cornerstoneTools.ellipticalRoi.enable(this.element);\n        cornerstoneTools.rectangleRoi.enable(this.element);\n        cornerstoneTools.wwwcTouchDrag.activate(this.element) // - Drag\n        cornerstoneTools.zoomTouchPinch.activate(this.element) // - Pinch\n        cornerstoneTools.panMultiTouch.activate(this.element) // - Multi (x2) */\n\n    // Stack tools\n\n    // Define the Stack object\n    const stack = {\n      currentImageIdIndex: this.currentIndex,\n      imageIds: this.imageIdList\n    };\n\n    cornerstoneTools.addStackStateManager(this.element, ['playClip']);\n    // Add the stack tool state to the enabled element\n    cornerstoneTools.addStackStateManager(this.element, ['stack']);\n    cornerstoneTools.addToolState(this.element, 'stack', stack);\n    // cornerstoneTools.stackScrollWheel.activate(this.element);\n    // Enable all tools we want to use with this element\n    cornerstoneTools.setToolActiveForElement(this.element, 'StackScroll', {});\n    //cornerstoneTools.stackPrefetch.enable(this.element);\n\n  }\n\n\n  // cornerstone.displayImage(this.element, image);\n  // deactivate all tools\n  public resetAllTools() {\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Wwwc');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Pan');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Zoom');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Probe');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Length');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Angle');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'EllipticalRoi');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'RectangleRoi');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'DragProbe');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'ZoomTouchPinch');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'PanMultiTouch');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'StackScroll');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'StackScrollMouseWheel');\n  }\n\n}\n","import { Directive, ElementRef, OnInit, Input, AfterViewChecked } from '@angular/core';\n\n\ndeclare const cornerstone;\n\n\n@Directive({\n  selector: '[thumbnail]',\n})\n\nexport class ThumbnailDirective implements OnInit, AfterViewChecked {\n\n  @Input() public imageData: any;\n\n  public element: any;\n\n  constructor(private elementRef: ElementRef) {\n  }\n\n  ngOnInit() {\n // Retrieve the DOM element itself\n    this.element = this.elementRef.nativeElement;\n\n    // Enable the element with Cornerstone\n    cornerstone.enable(this.element);\n    this.setImageData(this.imageData);\n  }\n\n  ngAfterViewChecked() {\n    this.refresh();\n  }\n\n  public refresh() {\n    this.setImageData(this.imageData);\n  }\n\n  public setImageData(image) {\n    this.imageData = image;\n    if (this.imageData && this.element) {\n      const viewport = cornerstone.getDefaultViewportForImage(this.element, this.imageData);\n      cornerstone.displayImage(this.element, this.imageData, viewport);\n      // Fit the image to the viewport window\n      cornerstone.fitToWindow(this.element);\n      cornerstone.resize(this.element, true);\n    }\n\n  }\n}\n","import { Component, ViewChild, OnInit, Input, ViewChildren } from '@angular/core';\nimport { CornerstoneDirective } from './cornerstone.directive';\nimport { ThumbnailDirective } from './thumbnail.directive';\n\n\n\ndeclare const cornerstone;\ndeclare const cornerstoneTools;\n\n@Component({\n  selector: 'dicom-viewer',\n  templateUrl: './dicom-viewer.component.html',\n  styleUrls: ['./dicom-viewer.component.css']\n})\nexport class DICOMViewerComponent implements OnInit {\n\n  @Input() public enableViewerTools = false; // enable viewer tools\n  @Input() public enablePlayTools = false; // enable Play Clip tools\n  @Input() public downloadImagesURL = '' // download images URL\n  @Input() public maxImagesToLoad = 20; // limit for the automatic loading of study images\n\n  public seriesList = []; // list of series on the images being displayed\n  public currentSeriesIndex = 0;\n  public currentSeries: any = {};\n  public imageCount = 0; // total image count being viewed\n\n  // control enable/disable image scroll buttons\n  public get hidePreviousImage(): any { return { color: (this.viewPort.currentIndex < 1) ? 'black' : 'white' }; }\n  public get hideNextImage(): any { return { color: (this.viewPort.currentIndex >= (this.imageCount - 1)) ? 'black' : 'white' }; }\n\n  // control message for more images to load\n  public get moreImagestoLoad(): string {\n    if (this.loadedImages.length < this.imageIdList.length && !this.loadingImages) { // are there any more images to load?\n      const imagesToLoad = (this.maxImagesToLoad <= 0) ? (this.imageIdList.length - this.loadedImages.length) : Math.min(this.maxImagesToLoad, this.imageIdList.length - this.loadedImages.length);\n      return imagesToLoad.toString();\n    } else return '';\n  }\n\n  // control exhibition of a loading images progress indicator\n  public loadingImages = false;\n  public get showProgress(): any { return { display: (this.loadingImages) ? 'inline-block' : 'none' } };\n\n  @ViewChild(CornerstoneDirective, { static: true }) viewPort: CornerstoneDirective; // the main cornertone view port\n  @ViewChildren(ThumbnailDirective) thumbnails: Array<ThumbnailDirective>;\n\n  private loadedImages = [];\n  private imageIdList = [];\n  private element: any;\n  private targetImageCount = 0;\n\n  constructor() { }\n\n  ngOnInit() {\n    this.element = this.viewPort.element;\n  }\n\n  /**\n   * Load dicom images for display\n   *\n   * @param imageIdList list of imageIds to load and display\n   */\n  loadStudyImages(imageIdList: Array<any>) {\n    this.element = this.viewPort.element;\n    this.imageIdList = imageIdList;\n    this.viewPort.resetViewer();\n    this.viewPort.resetImageCache(); // clean up image cache\n    this.seriesList = []; // start a new series list\n    this.currentSeriesIndex = 0; // always display first series\n    this.loadedImages = []; // reset list of images already loaded\n\n    //\n    // loop thru all imageIds, load and cache them for exhibition (up the the maximum limit defined)\n    //\n    const maxImages = (this.maxImagesToLoad <= 0) ? imageIdList.length : Math.min(this.maxImagesToLoad, imageIdList.length);\n    this.loadingImages = true; // activate progress indicator\n    this.targetImageCount = maxImages;\n    for (let index = 0; index < maxImages; index++) {\n      const imageId = imageIdList[index];\n      cornerstone.loadAndCacheImage(imageId).then(imageData => { this.imageLoaded(imageData) });\n    }\n\n  }\n\n  /**\n   * Load the next batch of images\n   */\n  public loadMoreImages() {\n    this.element = this.viewPort.element;\n    //\n    // loop thru all imageIds, load and cache them for exhibition (up the the maximum limit defined)\n    //\n    const maxImages = (this.maxImagesToLoad <= 0) ? (this.imageIdList.length - this.loadedImages.length) : Math.min(this.maxImagesToLoad, this.imageIdList.length - this.loadedImages.length);\n    this.loadingImages = true; // activate progress indicator\n    this.targetImageCount += maxImages;\n    let nextImageIndex = this.loadedImages.length;\n    for (let index = 0; index < maxImages; index++) {\n      const imageId = this.imageIdList[nextImageIndex++];\n      cornerstone.loadAndCacheImage(imageId)\n        .then(imageData => { this.imageLoaded(imageData) })\n        .catch(err => { this.targetImageCount--; });\n    }\n\n  }\n\n  /**\n   *\n   * @param imageData the dicom image data\n   */\n  private imageLoaded(imageData) {\n    //console.log(imageData.imageId)\n    // build list of series in all loadded images\n    const series = {\n      studyID: imageData.data.string('x0020000d'),\n      seriesID: imageData.data.string('x0020000e'),\n      seriesNumber: imageData.data.intString('x00200011'),\n      studyDescription: imageData.data.string('x00081030'),\n      seriesDescription: imageData.data.string('x0008103e'),\n      imageCount: 1,\n      imageList: [imageData]\n    }\n    // if this is a new series, add it to the list\n    let seriesIndex = this.seriesList.findIndex(item => item.seriesID === series.seriesID);\n    if (seriesIndex < 0) {\n      seriesIndex = this.seriesList.length;\n      this.seriesList.push(series);\n      this.seriesList.sort((a, b) => {\n        if (a.seriesNumber > b.seriesNumber) return 1;\n        if (a.seriesNumber < b.seriesNumber) return -1;\n        return 0;\n      })\n    } else {\n      let seriesItem = this.seriesList[seriesIndex];\n      seriesItem.imageCount++;\n      seriesItem.imageList.push(imageData);\n      seriesItem.imageList.sort((a, b) => {\n        if (a.data.intString('x00200013') > b.data.intString('x00200013')) return 1;\n        if (a.data.intString('x00200013') < b.data.intString('x00200013')) return -1;\n        return 0;\n      })\n    }\n\n    this.loadedImages.push(imageData); // save to images loaded\n\n    if (seriesIndex === this.currentSeriesIndex) {\n      //this.currentSeries = this.seriesList[seriesIndex];\n      //this.imageCount = this.currentSeries.imageCount; // get total image count\n      //this.viewPort.addImageData(imageData);\n      this.showSeries(this.currentSeriesIndex)\n    }\n\n    if (this.loadedImages.length >= this.targetImageCount) { // did we finish loading images?\n      this.loadingImages = false; // deactivate progress indicator\n    }\n\n  }\n\n  public showSeries(index) {\n    //        this.resetAllTools();\n    this.currentSeriesIndex = index;\n    this.currentSeries = this.seriesList[index];\n    this.imageCount = this.currentSeries.imageCount; // get total image count\n    this.viewPort.resetImageCache(); // clean up image cache\n    //        this.loadingImages = true; // activate progress indicator\n    for (let i = 0; i < this.currentSeries.imageList.length; i++) {\n      const imageData = this.currentSeries.imageList[i];\n      this.viewPort.addImageData(imageData);\n    }\n    //        this.loadingImages = false; // de-activate progress indicator\n  }\n\n  public saveAs() {\n    cornerstoneTools.saveAs(this.element, \"teste.jpg\")\n  }\n\n  /**\n   * Image scroll methods\n   */\n  public nextImage() {\n    if (this.viewPort.currentIndex < this.imageCount) {\n      this.viewPort.nextImage();\n    }\n  }\n\n  public previousImage() {\n    if (this.viewPort.currentIndex > 0) {\n      this.viewPort.previousImage();\n    }\n  }\n\n  /**\n   * Methods to activate/deactivate viewer tools\n   */\n\n  // deactivate all tools\n  public resetAllTools() {\n    if (this.imageCount > 0) {\n      this.viewPort.resetAllTools()\n      this.stopClip();\n    }\n  }\n\n  // activate windowing\n  public enableWindowing() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.wwwc.activate(this.element, 1);\n      // cornerstoneTools.wwwcTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Wwwc', { mouseButtonMask: 1 }, ['Mouse']);\n\n    }\n  }\n\n  // activate zoom\n  public enableZoom() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.zoom.activate(this.element, 5); // 5 is right mouse button and left mouse button\n      // cornerstoneTools.zoomTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Zoom', { mouseButtonMask: 1 }, ['Mouse']); // zoom left mouse\n      // cornerstoneTools.setToolActiveForElement(this.element, 'ZoomTouchPinch', { }, ['Mouse']);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 2 }, ['Mouse']); // pan right mouse\n\n    }\n  }\n\n  // activate pan\n  public enablePan() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.pan.activate(this.element, 3); // 3 is middle mouse button and left mouse button\n      // cornerstoneTools.panTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate image scroll\n  public enableScroll() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.stackScroll.activate(this.element, 1);\n      // cornerstoneTools.stackScrollTouchDrag.activate(this.element);\n      // cornerstoneTools.stackScrollKeyboard.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'StackScroll', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate length measurement\n  public enableLength() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.length.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Length', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate angle measurement\n  public enableAngle() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.simpleAngle.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Angle', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate pixel probe\n  public enableProbe() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.probe.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Probe', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate Elliptical ROI\n  public enableElliptical() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.ellipticalRoi.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'EllipticalRoi', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate Rectangle ROI\n  public enableRectangle() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.rectangleRoi.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'RectangleRoi', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // Play Clip\n  public playClip() {\n    if (this.imageCount > 0) {\n      let frameRate = 10;\n      let stackState = cornerstoneTools.getToolState(this.element, 'stack');\n      if (stackState) {\n        frameRate = stackState.data[0].frameRate;\n        // Play at a default 10 FPS if the framerate is not specified\n        if (frameRate === undefined || frameRate === null || frameRate === 0) {\n          frameRate = 10;\n        }\n      }\n      cornerstoneTools.playClip(this.element, frameRate);\n    }\n  }\n\n  // Stop Clip\n  public stopClip() {\n    cornerstoneTools.stopClip(this.element);\n  }\n\n  // invert image\n  public invertImage() {\n    if (this.imageCount > 0) {\n      let viewport = cornerstone.getViewport(this.element);\n      // Toggle invert\n      if (viewport.invert === true) {\n        viewport.invert = false;\n      } else {\n        viewport.invert = true;\n      }\n      cornerstone.setViewport(this.element, viewport);\n    }\n  }\n\n  // reset image\n  public resetImage() {\n    if (this.imageCount > 0) {\n      let toolStateManager = cornerstoneTools.getElementToolStateManager(this.element);\n      // Note that this only works on ImageId-specific tool state managers (for now)\n      //toolStateManager.clear(this.element);\n      cornerstoneTools.clearToolState(this.element, \"Length\");\n      cornerstoneTools.clearToolState(this.element, \"Angle\");\n      // cornerstoneTools.clearToolState(this.element, \"simpleAngle\");\n      cornerstoneTools.clearToolState(this.element, \"Probe\");\n      cornerstoneTools.clearToolState(this.element, \"EllipticalRoi\");\n      cornerstoneTools.clearToolState(this.element, \"RectangleRoi\");\n      cornerstone.updateImage(this.element);\n      this.resetAllTools();\n    }\n  }\n\n  public clearImage() {\n    this.viewPort.resetViewer();\n    this.viewPort.resetImageCache();\n    this.seriesList = []; // list of series on the images being displayed\n    this.currentSeriesIndex = 0;\n    this.currentSeries = {};\n    this.imageCount = 0; // total image count being viewed\n\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\n\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\n\nimport { DICOMViewerComponent } from './dicom-viewer.component';\nimport { CornerstoneDirective } from './cornerstone.directive';\nimport { ThumbnailDirective } from './thumbnail.directive';\n\n@NgModule({\n  imports: [\n    FormsModule,\n    CommonModule,\n    MatProgressSpinnerModule\n  ],\n  declarations: [DICOMViewerComponent, CornerstoneDirective, ThumbnailDirective],\n  exports: [DICOMViewerComponent, CornerstoneDirective, ThumbnailDirective]\n})\nexport class DicomViewerModule { }\n","/*\n * Public API Surface of dicom-viewer\n */\n\nexport * from './lib/dicom-viewer.component';\nexport * from './lib/cornerstone.directive';\nexport * from './lib/thumbnail.directive';\nexport * from './lib/dicom-viewer.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["Hammer","Directive","ElementRef","HostListener","Input","Component","ViewChild","ViewChildren","NgModule","FormsModule","CommonModule","MatProgressSpinnerModule"],"mappings":"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"}