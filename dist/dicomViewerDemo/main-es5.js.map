{"version":3,"sources":["webpack:///src/environments/environment.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///dist/projects/dicom-viewer/src/lib/cornerstone.directive.ts","webpack:///dist/projects/dicom-viewer/src/lib/thumbnail.directive.ts","webpack:///dist/projects/dicom-viewer/src/lib/dicom-viewer.component.ts","webpack:///dist/projects/dicom-viewer/src/lib/dicom-viewer.module.ts","webpack:///dist/projects/dicom-viewer/src/public_api.ts","webpack:///dist/projects/dicom-viewer/src/ng-dicomviewer.ts","webpack:///src/main.ts","webpack:///$_lazy_route_resource lazy namespace object"],"names":["environment","production","AppComponent","cornerstoneWADOImageLoader","external","cornerstone","webWorkerManager","initialize","webWorkerPath","taskConfiguration","codecsPath","files","length","imageList","fileList","Array","from","sort","a","b","name","wadouri","dataSetCacheManager","purge","i","dicomFile","imageId","fileManager","add","push","viewPort","resetAllTools","loadStudyImages","alert","loadDICOMImages","AppModule","CornerstoneDirective","elementRef","imageIdList","currentIndex","patientName","hospital","instanceNumber","WwwcTool","cornerstoneTools","PanTool","ZoomTool","ProbeTool","LengthTool","AngleTool","EllipticalRoiTool","RectangleRoiTool","DragProbeTool","ZoomTouchPinchTool","PanMultiTouchTool","StackScrollTool","StackScrollMouseWheelTool","isCornerstoneEnabled","viewport","getViewport","element","currentImage","Math","round","voi","windowWidth","windowCenter","scale","toFixed","event","resize","preventDefault","delta","max","min","wheelDelta","detail","displayImage","nativeElement","Hammer","cornerstoneMath","init","globalToolSyncEnabled","addTool","resetViewer","disableViewer","enable","disable","imageData","image","getDefaultViewportForImage","fitToWindow","data","string","replace","intString","setToolActiveForElement","mouseButtonMask","stack","currentImageIdIndex","imageIds","addStackStateManager","addToolState","setToolDisabledForElement","ThumbnailDirective","setImageData","refresh","DICOMViewerComponent","enableViewerTools","enablePlayTools","downloadImagesURL","maxImagesToLoad","seriesList","currentSeriesIndex","currentSeries","imageCount","loadingImages","loadedImages","targetImageCount","color","imagesToLoad","toString","display","resetImageCache","maxImages","index","loadAndCacheImage","then","imageLoaded","nextImageIndex","err","series","studyID","seriesID","seriesNumber","studyDescription","seriesDescription","seriesIndex","findIndex","item","seriesItem","showSeries","addImageData","saveAs","nextImage","previousImage","stopClip","frameRate","stackState","getToolState","undefined","playClip","invert","setViewport","toolStateManager","getElementToolStateManager","clearToolState","updateImage","DicomViewerModule","bootstrapModule","console","error","webpackEmptyAsyncContext","req","Promise","resolve","e","Error","code","keys","module","exports","id"],"mappings":"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","file":"main-es5.js","sourcesContent":["// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { DICOMViewerComponent } from 'dicomViewer';\n\ndeclare const cornerstone;\ndeclare const cornerstoneWADOImageLoader;\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit {\n\n  @ViewChild(DICOMViewerComponent, { static: true }) viewPort: DICOMViewerComponent;\n\n  ngOnInit() {\n    cornerstoneWADOImageLoader.external.cornerstone = cornerstone; // inicializa WADO Image loader\n\n    // configura codecs e web workers\n    cornerstoneWADOImageLoader.webWorkerManager.initialize({\n        webWorkerPath: './assets/cornerstone/webworkers/cornerstoneWADOImageLoaderWebWorker.js',\n        taskConfiguration: {\n            'decodeTask': {\n                codecsPath: '../codecs/cornerstoneWADOImageLoaderCodecs.js'\n            }\n        }\n    });\n\n  }\n\n  /**\n   * Load selected DICOM images\n   *\n   * @param files list of selected dicom files\n   */\n  loadDICOMImages(files: FileList) {\n    if (files && files.length > 0) {\n      let imageList = [];\n      const fileList:Array<File> = Array.from(files);\n      fileList.sort((a,b) => {\n        if ( a.name > b.name ) return 1;\n        if ( b.name > a.name ) return -1;\n        return 0;\n      })\n      //cornerstoneWADOImageLoader.wadouri.fileManager.purge();\n      cornerstoneWADOImageLoader.wadouri.dataSetCacheManager.purge();\n\n      // loop thru the File list and build a list of wadouri imageIds (dicomfile:)\n      for (let i = 0; i < fileList.length; i++) {\n        const dicomFile: File = fileList[i];\n        const imageId = cornerstoneWADOImageLoader.wadouri.fileManager.add(dicomFile);\n        imageList.push(imageId);\n      }\n\n      this.viewPort.resetAllTools();\n\n      // now load all Images, using their wadouri\n      this.viewPort.loadStudyImages(imageList);\n\n    } else alert('Escolha imagens DICOM a exibir.');\n  }\n}\n","<div style=\"height:100%; width: 100%;\">\n  <div style=\"display: flex; margin-left: 120px; align-items: center;\">\n    <h1>\n      DICOM Viewer, based on <a href=\"https://github.com/cornerstonejs\">Cornerstone</a>\n    </h1>\n\n    <div class=\"choose_file\">\n      Choose Your DICOM Files\n      <input class=\"hide_file\" type=\"file\" multiple accept=\"application/dicom\" id=\"imagens\" title=\"selecione arquivos de imagens\"\n      (change)=\"loadDICOMImages($event.target.files)\">\n    </div>\n\n\n\n  </div>\n\n  <div style=\"display: flex;height: calc(100% - 90px); width:100%;\">\n    <dicom-viewer [enableViewerTools]=\"true\" [enablePlayTools]=\"false\" [maxImagesToLoad]=\"20\" style=\"height:100%; width:100%; margin: 10px;\"></dicom-viewer>\n  </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\n\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\n\nimport { AppComponent } from './app.component';\nimport { DicomViewerModule } from 'dicomViewer'\n\n@NgModule({\n  declarations: [\n    AppComponent,\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule,\n    CommonModule,\n    MatProgressSpinnerModule,\n    DicomViewerModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Directive, ElementRef, HostListener, OnInit, AfterViewChecked } from '@angular/core';\nimport * as Hammer from 'hammerjs';\n\n\ndeclare const cornerstone;\ndeclare const cornerstoneTools;\ndeclare const cornerstoneMath;\n\n\n\n\n@Directive({\n  selector: '[cornerstone]',\n})\n\nexport class CornerstoneDirective implements OnInit, AfterViewChecked {\n\n  public element: any;\n\n  public imageList = [];\n  private imageIdList = [];\n  public currentIndex = 0;\n  public currentImage: any;\n  public patientName = ''; // current image Patient name, do display on the overlay\n  public hospital = ''; // current image Institution name, to display on the overlay\n  public instanceNumber = ''; // current image Instance #, to display on the overlay\n\n  // cornersTone Tools we use\n  private WwwcTool = cornerstoneTools.WwwcTool;\n  private PanTool = cornerstoneTools.PanTool;\n  private ZoomTool = cornerstoneTools.ZoomTool;\n  private ProbeTool = cornerstoneTools.ProbeTool;\n  private LengthTool = cornerstoneTools.LengthTool;\n  private AngleTool = cornerstoneTools.AngleTool;\n  private EllipticalRoiTool = cornerstoneTools.EllipticalRoiTool;\n  private RectangleRoiTool = cornerstoneTools.RectangleRoiTool;\n  private DragProbeTool = cornerstoneTools.DragProbeTool;\n  private ZoomTouchPinchTool = cornerstoneTools.ZoomTouchPinchTool;\n  private PanMultiTouchTool = cornerstoneTools.PanMultiTouchTool;\n  private StackScrollTool = cornerstoneTools.StackScrollTool;\n  private StackScrollMouseWheelTool = cornerstoneTools.StackScrollMouseWheelTool;\n\n\n  public get windowingValue(): string {\n    if (this.isCornerstoneEnabled) {\n      let viewport = cornerstone.getViewport(this.element);\n      if (this.currentImage && viewport) { return Math.round(viewport.voi.windowWidth) + \"/\" + Math.round(viewport.voi.windowCenter); }\n    }\n    return '';\n  }\n\n  public get zoomValue(): string {\n    if (this.isCornerstoneEnabled) {\n      let viewport = cornerstone.getViewport(this.element);\n      if (this.currentImage && viewport) { return viewport.scale.toFixed(2); }\n    }\n    return '';\n  }\n\n  private isCornerstoneEnabled = false;\n\n  constructor(private elementRef: ElementRef) {\n  }\n\n  @HostListener('window:resize', ['$event'])\n  onResize(event) {\n    if (this.isCornerstoneEnabled) {\n      cornerstone.resize(this.element, true);\n    }\n  }\n\n  @HostListener('wheel', ['$event'])\n  onMouseWheel(event) {\n    event.preventDefault();\n\n    if (this.imageList.length > 0) {\n      const delta = Math.max(-1, Math.min(1, (event.wheelDelta || -event.detail)));\n      // console.log(event);\n\n\n      if (delta > 0) {\n        this.currentIndex++;\n        if (this.currentIndex >= this.imageList.length) {\n          this.currentIndex = this.imageList.length - 1;\n        }\n      } else {\n\n        this.currentIndex--;\n        if (this.currentIndex < 0) {\n          this.currentIndex = 0;\n        }\n\n      }\n\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n\n  }\n\n  ngOnInit() {\n\n    // Retrieve the DOM element itself\n    this.element = this.elementRef.nativeElement;\n\n    // now add the Tools we use\n    cornerstoneTools.external.cornerstone = cornerstone;\n    cornerstoneTools.external.Hammer = Hammer;\n    cornerstoneTools.external.cornerstoneMath = cornerstoneMath;\n    cornerstoneTools.init({ globalToolSyncEnabled: true });\n\n    cornerstoneTools.addTool(this.WwwcTool);\n    cornerstoneTools.addTool(this.PanTool);\n    cornerstoneTools.addTool(this.ZoomTool);\n    cornerstoneTools.addTool(this.ProbeTool);\n    cornerstoneTools.addTool(this.LengthTool);\n    cornerstoneTools.addTool(this.AngleTool);\n    cornerstoneTools.addTool(this.EllipticalRoiTool);\n    cornerstoneTools.addTool(this.RectangleRoiTool);\n    cornerstoneTools.addTool(this.DragProbeTool);\n    cornerstoneTools.addTool(this.ZoomTouchPinchTool);\n    cornerstoneTools.addTool(this.PanMultiTouchTool);\n    cornerstoneTools.addTool(this.StackScrollTool);\n    cornerstoneTools.addTool(this.StackScrollMouseWheelTool);\n\n    // Enable the element with Cornerstone\n    this.resetViewer();\n  }\n\n  ngAfterViewChecked() {\n  //  if (this.currentImage) cornerstone.resize(this.element, true);\n  }\n\n  //\n  // reset the viewer, so only this current element is enabled\n  //\n  public resetViewer() {\n    this.disableViewer();\n    cornerstone.enable(this.element);\n    this.isCornerstoneEnabled = true;\n  }\n\n  public disableViewer() {\n    this.element = this.elementRef.nativeElement;\n    try {\n      cornerstone.disable(this.element);\n    } finally { }\n\n    this.isCornerstoneEnabled = false;\n  }\n\n  public resetImageCache() {\n    this.imageList = [];\n    this.imageIdList = [];\n    this.currentImage = null;\n    this.currentIndex = 0;\n    this.patientName = '';\n    this.hospital = '';\n    this.instanceNumber = '';\n  }\n\n  public previousImage() {\n    if (this.imageList.length > 0) {\n      this.currentIndex--;\n      if (this.currentIndex < 0) {\n        this.currentIndex = 0;\n      }\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n\n  }\n\n  public nextImage() {\n    if (this.imageList.length > 0) {\n      this.currentIndex++;\n      if (this.currentIndex >= this.imageList.length) {\n        this.currentIndex = this.imageList.length - 1;\n      }\n      this.displayImage(this.imageList[this.currentIndex]);\n    }\n  }\n\n  public addImageData(imageData: any) {\n    this.element = this.elementRef.nativeElement;\n    //if (!this.imageList.filter(img => img.imageId === imageData.imageId).length) {\n    this.imageList.push(imageData);\n    this.imageIdList.push(imageData.imageId);\n    if (this.imageList.length === 1) {\n      this.currentIndex = 0;\n      this.displayImage(imageData);\n    }\n    //}\n\n    cornerstone.resize(this.element, true);\n  }\n\n  public displayImage(image) {\n    this.element = this.elementRef.nativeElement;\n    const viewport = cornerstone.getDefaultViewportForImage(this.element, image);\n    cornerstone.displayImage(this.element, image, viewport);\n    this.currentImage = image;\n    // Fit the image to the viewport window\n    cornerstone.fitToWindow(this.element);\n    cornerstone.resize(this.element, true);\n\n    // get image info to display in overlays\n    if (image.data.string('x00100010')) this.patientName = image.data.string('x00100010').replace(/\\^/g, '');\n    this.hospital = image.data.string('x00080080');\n    this.instanceNumber = image.data.intString('x00200011') + '/' + image.data.intString('x00200013');\n\n    // Activate mouse clicks, mouse wheel and touch\n    // cornerstoneTools.mouseInput.enable(this.element);\n    // cornerstoneTools.mouseWheelInput.enable(this.element);\n    // //cornerstoneTools.touchInput.enable(this.element);\n    // cornerstoneTools.keyboardInput.enable(this.element);\n\n    // Enable all tools we want to use with this element\n    cornerstoneTools.setToolActiveForElement(this.element, 'Wwwc', { mouseButtonMask: 1 }, ['Mouse']); // ww/wc is the default tool for left mouse button\n    cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 4 }, ['Mouse']); // pan is the default tool for middle mouse button\n    cornerstoneTools.setToolActiveForElement(this.element, 'Zoom', { mouseButtonMask: 2 }, ['Mouse']); // zoom is the default tool for right mouse button\n\n    /*     cornerstoneTools.wwwc.activate(this.element, 1); // ww/wc is the default tool for left mouse button\n        cornerstoneTools.pan.activate(this.element, 2); // pan is the default tool for middle mouse button\n        cornerstoneTools.zoom.activate(this.element, 4); // zoom is the default tool for right mouse button\n        cornerstoneTools.probe.enable(this.element);\n        cornerstoneTools.length.enable(this.element);\n        cornerstoneTools.angle.enable(this.element);\n        cornerstoneTools.simpleAngle.enable(this.element);\n        cornerstoneTools.ellipticalRoi.enable(this.element);\n        cornerstoneTools.rectangleRoi.enable(this.element);\n        cornerstoneTools.wwwcTouchDrag.activate(this.element) // - Drag\n        cornerstoneTools.zoomTouchPinch.activate(this.element) // - Pinch\n        cornerstoneTools.panMultiTouch.activate(this.element) // - Multi (x2) */\n\n    // Stack tools\n\n    // Define the Stack object\n    const stack = {\n      currentImageIdIndex: this.currentIndex,\n      imageIds: this.imageIdList\n    };\n\n    cornerstoneTools.addStackStateManager(this.element, ['playClip']);\n    // Add the stack tool state to the enabled element\n    cornerstoneTools.addStackStateManager(this.element, ['stack']);\n    cornerstoneTools.addToolState(this.element, 'stack', stack);\n    // cornerstoneTools.stackScrollWheel.activate(this.element);\n    // Enable all tools we want to use with this element\n    cornerstoneTools.setToolActiveForElement(this.element, 'StackScroll', {});\n    //cornerstoneTools.stackPrefetch.enable(this.element);\n\n  }\n\n\n  // cornerstone.displayImage(this.element, image);\n  // deactivate all tools\n  public resetAllTools() {\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Wwwc');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Pan');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Zoom');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Probe');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Length');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'Angle');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'EllipticalRoi');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'RectangleRoi');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'DragProbe');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'ZoomTouchPinch');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'PanMultiTouch');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'StackScroll');\n    cornerstoneTools.setToolDisabledForElement(this.element, 'StackScrollMouseWheel');\n  }\n\n}\n","import { Directive, ElementRef, OnInit, Input, AfterViewChecked } from '@angular/core';\n\n\ndeclare const cornerstone;\n\n\n@Directive({\n  selector: '[thumbnail]',\n})\n\nexport class ThumbnailDirective implements OnInit, AfterViewChecked {\n\n  @Input() public imageData: any;\n\n  public element: any;\n\n  constructor(private elementRef: ElementRef) {\n  }\n\n  ngOnInit() {\n // Retrieve the DOM element itself\n    this.element = this.elementRef.nativeElement;\n\n    // Enable the element with Cornerstone\n    cornerstone.enable(this.element);\n    this.setImageData(this.imageData);\n  }\n\n  ngAfterViewChecked() {\n    this.refresh();\n  }\n\n  public refresh() {\n    this.setImageData(this.imageData);\n  }\n\n  public setImageData(image) {\n    this.imageData = image;\n    if (this.imageData && this.element) {\n      const viewport = cornerstone.getDefaultViewportForImage(this.element, this.imageData);\n      cornerstone.displayImage(this.element, this.imageData, viewport);\n      // Fit the image to the viewport window\n      cornerstone.fitToWindow(this.element);\n      cornerstone.resize(this.element, true);\n    }\n\n  }\n}\n","import { Component, ViewChild, OnInit, Input, ViewChildren } from '@angular/core';\nimport { CornerstoneDirective } from './cornerstone.directive';\nimport { ThumbnailDirective } from './thumbnail.directive';\n\n\n\ndeclare const cornerstone;\ndeclare const cornerstoneTools;\n\n@Component({\n  selector: 'dicom-viewer',\n  templateUrl: './dicom-viewer.component.html',\n  styleUrls: ['./dicom-viewer.component.css']\n})\nexport class DICOMViewerComponent implements OnInit {\n\n  @Input() public enableViewerTools = false; // enable viewer tools\n  @Input() public enablePlayTools = false; // enable Play Clip tools\n  @Input() public downloadImagesURL = '' // download images URL\n  @Input() public maxImagesToLoad = 20; // limit for the automatic loading of study images\n\n  public seriesList = []; // list of series on the images being displayed\n  public currentSeriesIndex = 0;\n  public currentSeries: any = {};\n  public imageCount = 0; // total image count being viewed\n\n  // control enable/disable image scroll buttons\n  public get hidePreviousImage(): any { return { color: (this.viewPort.currentIndex < 1) ? 'black' : 'white' }; }\n  public get hideNextImage(): any { return { color: (this.viewPort.currentIndex >= (this.imageCount - 1)) ? 'black' : 'white' }; }\n\n  // control message for more images to load\n  public get moreImagestoLoad(): string {\n    if (this.loadedImages.length < this.imageIdList.length && !this.loadingImages) { // are there any more images to load?\n      const imagesToLoad = (this.maxImagesToLoad <= 0) ? (this.imageIdList.length - this.loadedImages.length) : Math.min(this.maxImagesToLoad, this.imageIdList.length - this.loadedImages.length);\n      return imagesToLoad.toString();\n    } else return '';\n  }\n\n  // control exhibition of a loading images progress indicator\n  public loadingImages = false;\n  public get showProgress(): any { return { display: (this.loadingImages) ? 'inline-block' : 'none' } };\n\n  @ViewChild(CornerstoneDirective, { static: true }) viewPort: CornerstoneDirective; // the main cornertone view port\n  @ViewChildren(ThumbnailDirective) thumbnails: Array<ThumbnailDirective>;\n\n  private loadedImages = [];\n  private imageIdList = [];\n  private element: any;\n  private targetImageCount = 0;\n\n  constructor() { }\n\n  ngOnInit() {\n    this.element = this.viewPort.element;\n  }\n\n  /**\n   * Load dicom images for display\n   *\n   * @param imageIdList list of imageIds to load and display\n   */\n  loadStudyImages(imageIdList: Array<any>) {\n    this.element = this.viewPort.element;\n    this.imageIdList = imageIdList;\n    this.viewPort.resetViewer();\n    this.viewPort.resetImageCache(); // clean up image cache\n    this.seriesList = []; // start a new series list\n    this.currentSeriesIndex = 0; // always display first series\n    this.loadedImages = []; // reset list of images already loaded\n\n    //\n    // loop thru all imageIds, load and cache them for exhibition (up the the maximum limit defined)\n    //\n    const maxImages = (this.maxImagesToLoad <= 0) ? imageIdList.length : Math.min(this.maxImagesToLoad, imageIdList.length);\n    this.loadingImages = true; // activate progress indicator\n    this.targetImageCount = maxImages;\n    for (let index = 0; index < maxImages; index++) {\n      const imageId = imageIdList[index];\n      cornerstone.loadAndCacheImage(imageId).then(imageData => { this.imageLoaded(imageData) });\n    }\n\n  }\n\n  /**\n   * Load the next batch of images\n   */\n  public loadMoreImages() {\n    this.element = this.viewPort.element;\n    //\n    // loop thru all imageIds, load and cache them for exhibition (up the the maximum limit defined)\n    //\n    const maxImages = (this.maxImagesToLoad <= 0) ? (this.imageIdList.length - this.loadedImages.length) : Math.min(this.maxImagesToLoad, this.imageIdList.length - this.loadedImages.length);\n    this.loadingImages = true; // activate progress indicator\n    this.targetImageCount += maxImages;\n    let nextImageIndex = this.loadedImages.length;\n    for (let index = 0; index < maxImages; index++) {\n      const imageId = this.imageIdList[nextImageIndex++];\n      cornerstone.loadAndCacheImage(imageId)\n        .then(imageData => { this.imageLoaded(imageData) })\n        .catch(err => { this.targetImageCount--; });\n    }\n\n  }\n\n  /**\n   *\n   * @param imageData the dicom image data\n   */\n  private imageLoaded(imageData) {\n    //console.log(imageData.imageId)\n    // build list of series in all loadded images\n    const series = {\n      studyID: imageData.data.string('x0020000d'),\n      seriesID: imageData.data.string('x0020000e'),\n      seriesNumber: imageData.data.intString('x00200011'),\n      studyDescription: imageData.data.string('x00081030'),\n      seriesDescription: imageData.data.string('x0008103e'),\n      imageCount: 1,\n      imageList: [imageData]\n    }\n    // if this is a new series, add it to the list\n    let seriesIndex = this.seriesList.findIndex(item => item.seriesID === series.seriesID);\n    if (seriesIndex < 0) {\n      seriesIndex = this.seriesList.length;\n      this.seriesList.push(series);\n      this.seriesList.sort((a, b) => {\n        if (a.seriesNumber > b.seriesNumber) return 1;\n        if (a.seriesNumber < b.seriesNumber) return -1;\n        return 0;\n      })\n    } else {\n      let seriesItem = this.seriesList[seriesIndex];\n      seriesItem.imageCount++;\n      seriesItem.imageList.push(imageData);\n      seriesItem.imageList.sort((a, b) => {\n        if (a.data.intString('x00200013') > b.data.intString('x00200013')) return 1;\n        if (a.data.intString('x00200013') < b.data.intString('x00200013')) return -1;\n        return 0;\n      })\n    }\n\n    this.loadedImages.push(imageData); // save to images loaded\n\n    if (seriesIndex === this.currentSeriesIndex) {\n      //this.currentSeries = this.seriesList[seriesIndex];\n      //this.imageCount = this.currentSeries.imageCount; // get total image count\n      //this.viewPort.addImageData(imageData);\n      this.showSeries(this.currentSeriesIndex)\n    }\n\n    if (this.loadedImages.length >= this.targetImageCount) { // did we finish loading images?\n      this.loadingImages = false; // deactivate progress indicator\n    }\n\n  }\n\n  public showSeries(index) {\n    //        this.resetAllTools();\n    this.currentSeriesIndex = index;\n    this.currentSeries = this.seriesList[index];\n    this.imageCount = this.currentSeries.imageCount; // get total image count\n    this.viewPort.resetImageCache(); // clean up image cache\n    //        this.loadingImages = true; // activate progress indicator\n    for (let i = 0; i < this.currentSeries.imageList.length; i++) {\n      const imageData = this.currentSeries.imageList[i];\n      this.viewPort.addImageData(imageData);\n    }\n    //        this.loadingImages = false; // de-activate progress indicator\n  }\n\n  public saveAs() {\n    cornerstoneTools.saveAs(this.element, \"teste.jpg\")\n  }\n\n  /**\n   * Image scroll methods\n   */\n  public nextImage() {\n    if (this.viewPort.currentIndex < this.imageCount) {\n      this.viewPort.nextImage();\n    }\n  }\n\n  public previousImage() {\n    if (this.viewPort.currentIndex > 0) {\n      this.viewPort.previousImage();\n    }\n  }\n\n  /**\n   * Methods to activate/deactivate viewer tools\n   */\n\n  // deactivate all tools\n  public resetAllTools() {\n    if (this.imageCount > 0) {\n      this.viewPort.resetAllTools()\n      this.stopClip();\n    }\n  }\n\n  // activate windowing\n  public enableWindowing() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.wwwc.activate(this.element, 1);\n      // cornerstoneTools.wwwcTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Wwwc', { mouseButtonMask: 1 }, ['Mouse']);\n\n    }\n  }\n\n  // activate zoom\n  public enableZoom() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.zoom.activate(this.element, 5); // 5 is right mouse button and left mouse button\n      // cornerstoneTools.zoomTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Zoom', { mouseButtonMask: 1 }, ['Mouse']); // zoom left mouse\n      // cornerstoneTools.setToolActiveForElement(this.element, 'ZoomTouchPinch', { }, ['Mouse']);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 2 }, ['Mouse']); // pan right mouse\n\n    }\n  }\n\n  // activate pan\n  public enablePan() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.pan.activate(this.element, 3); // 3 is middle mouse button and left mouse button\n      // cornerstoneTools.panTouchDrag.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Pan', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate image scroll\n  public enableScroll() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.stackScroll.activate(this.element, 1);\n      // cornerstoneTools.stackScrollTouchDrag.activate(this.element);\n      // cornerstoneTools.stackScrollKeyboard.activate(this.element);\n      cornerstoneTools.setToolActiveForElement(this.element, 'StackScroll', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate length measurement\n  public enableLength() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.length.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Length', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate angle measurement\n  public enableAngle() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.simpleAngle.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Angle', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate pixel probe\n  public enableProbe() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.probe.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'Probe', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate Elliptical ROI\n  public enableElliptical() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.ellipticalRoi.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'EllipticalRoi', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // activate Rectangle ROI\n  public enableRectangle() {\n    if (this.imageCount > 0) {\n      this.resetAllTools();\n      // cornerstoneTools.rectangleRoi.activate(this.element, 1);\n      cornerstoneTools.setToolActiveForElement(this.element, 'RectangleRoi', { mouseButtonMask: 1 }, ['Mouse']);\n    }\n  }\n\n  // Play Clip\n  public playClip() {\n    if (this.imageCount > 0) {\n      let frameRate = 10;\n      let stackState = cornerstoneTools.getToolState(this.element, 'stack');\n      if (stackState) {\n        frameRate = stackState.data[0].frameRate;\n        // Play at a default 10 FPS if the framerate is not specified\n        if (frameRate === undefined || frameRate === null || frameRate === 0) {\n          frameRate = 10;\n        }\n      }\n      cornerstoneTools.playClip(this.element, frameRate);\n    }\n  }\n\n  // Stop Clip\n  public stopClip() {\n    cornerstoneTools.stopClip(this.element);\n  }\n\n  // invert image\n  public invertImage() {\n    if (this.imageCount > 0) {\n      let viewport = cornerstone.getViewport(this.element);\n      // Toggle invert\n      if (viewport.invert === true) {\n        viewport.invert = false;\n      } else {\n        viewport.invert = true;\n      }\n      cornerstone.setViewport(this.element, viewport);\n    }\n  }\n\n  // reset image\n  public resetImage() {\n    if (this.imageCount > 0) {\n      let toolStateManager = cornerstoneTools.getElementToolStateManager(this.element);\n      // Note that this only works on ImageId-specific tool state managers (for now)\n      //toolStateManager.clear(this.element);\n      cornerstoneTools.clearToolState(this.element, \"Length\");\n      cornerstoneTools.clearToolState(this.element, \"Angle\");\n      // cornerstoneTools.clearToolState(this.element, \"simpleAngle\");\n      cornerstoneTools.clearToolState(this.element, \"Probe\");\n      cornerstoneTools.clearToolState(this.element, \"EllipticalRoi\");\n      cornerstoneTools.clearToolState(this.element, \"RectangleRoi\");\n      cornerstone.updateImage(this.element);\n      this.resetAllTools();\n    }\n  }\n\n  public clearImage() {\n    this.viewPort.resetViewer();\n    this.viewPort.resetImageCache();\n    this.seriesList = []; // list of series on the images being displayed\n    this.currentSeriesIndex = 0;\n    this.currentSeries = {};\n    this.imageCount = 0; // total image count being viewed\n\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\n\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\n\nimport { DICOMViewerComponent } from './dicom-viewer.component';\nimport { CornerstoneDirective } from './cornerstone.directive';\nimport { ThumbnailDirective } from './thumbnail.directive';\n\n@NgModule({\n  imports: [\n    FormsModule,\n    CommonModule,\n    MatProgressSpinnerModule\n  ],\n  declarations: [DICOMViewerComponent, CornerstoneDirective, ThumbnailDirective],\n  exports: [DICOMViewerComponent, CornerstoneDirective, ThumbnailDirective]\n})\nexport class DicomViewerModule { }\n","/*\n * Public API Surface of dicom-viewer\n */\n\nexport * from './lib/dicom-viewer.component';\nexport * from './lib/cornerstone.directive';\nexport * from './lib/thumbnail.directive';\nexport * from './lib/dicom-viewer.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"]}